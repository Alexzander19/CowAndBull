
{% extends 'base.html' %}
{% load static %}
    
{% block content %}

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->

<div class="container mt-5">
    <h1>–ò–≥—Ä–∞ –≤ "–ö–û–†–û–í-–ë–´–ö–û–í"</h1>
    <p>–ó–∞–≥–∞–¥–∞–Ω–æ —á–∏—Å–ª–æ –∏–∑ : <span id="selectedNumber"></span> —Ü–∏—Ñ—Ä. –í–∞–º –Ω—É–∂–Ω–æ –∏—Ö –æ—Ç–≥–∞–¥–∞—Ç—å.</p>
    <p>–í –ø–æ–¥–±–∏—Ä–∞–µ–º–æ–º —á–∏—Å–ª–µ –Ω–µ–ª—å–∑—è –ø—Ä–æ–ø–∏—Å–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ü–∏—Ñ—Ä—ã</p>
    <p>"–ö–æ—Ä–æ–≤—ã" - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏—Ñ—Ä —É–≥–∞–¥–∞–Ω–Ω—ã—Ö, –Ω–æ –Ω–µ –Ω–∞ —Å–≤–æ–µ–º –º–µ—Å—Ç–µ</p>
    <p>"–ë—ã–∫–∏" - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏—Ñ—Ä —É–≥–∞–¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞ —Å–≤–æ–µ–º –º–µ—Å—Ç–µ</p>
    
</div>

<div class="container-fluid">
    <div class="row">
        <!-- –ö–æ–ª–æ–Ω–∫–∞ –∏–≥—Ä—ã -->
        <div class="col-12 col-md-8 game-column">
            
            <div class="table-game"  >
                <button type="button" class="btn btn-primary" id ='openModalButton'  > –ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É</button>
                <!--<div class="table-game">  —á—Ç–æ–±—ã —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∞—Å—å –ø–æ—Å–ª–µ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è   -->
                
                  <div class="table-row">
                    <div class="table-col">–ß–ò–°–õ–û</div>
                    <div class="table-col">
                      <img class = "cow-bull-image" src="{% static 'img/system/cow.png' %}" alt = 'cow'> /  
                      <img class = "cow-bull-image" src="{% static 'img/system/bull.png' %}" alt = 'bull'>
                    </div>
                    <div class="table-col">–®–ê–ì</div>
                  </div>
                 
                  <div class="table-row " id = "div-table-interactive">
                    <div class="table-col align-left">
                      <input id="userInput" autocomplete="off" class="table-input" aria-label="userInput">
                    </div>
                    <div class="table-col">
                    <span id = 'timetext'> </span> <span id = 'time'></span>  
                    </div>
                    <div class="table-col">
                      <button class="btn btn-primary" onclick="cowBullUserTry(); return false;">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    </div>
                  </div>
                
            </div>

          

                
            </div>
        </div>



        <!-- –ö–æ–ª–æ–Ω–∫–∞ —á–∞—Ç–∞ -->
    <div class="col-12 col-md-4">
            <!-- <div class="chat-column"> -->
                <!-- <h4>–ß–∞—Ç –∏–≥—Ä–æ–∫–æ–≤</h4>
                <div class="chat-messages"> -->
                    <!-- –ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π -->

                    <!-- {% for user in users %}
                        <div class="card" style="width: 18rem;" >
                            <img src={{user.avatar_pic.url}} class="card-img-top" alt="...">
                            <div class="card-body">
                                <h5 class="card-title"><a href = "#">{{user}} </a></h5>
                                <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                                <a href="#" class="btn btn-primary">Go somewhere</a>
                            </div>
                        </div>
                
                    {% endfor %} -->

                        <!-- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–∞—Ç–∞ -->
<div class="container-fluid vh-100 d-flex flex-column">
  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —á–∞—Ç–∞ -->
  <div class="row py-3  border-bottom " style='background-color: blsck;' >
      <div class="col d-flex align-items-center">
          <h4 class="mb-0">–°–µ–º–µ–π–Ω—ã–π —á–∞—Ç–∏–∫</h4>
      </div>
  </div>

  <!-- –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π -->
  <div class="row flex-grow-1 overflow-y-auto" style="background-color: black;">
      <div class="col py-3" style="background-color: black;" id = "div-all-messages-in-chat">
          <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –¥—Ä—É–≥–∏—Ö -->

        {% for message in messages %}

          

          <div div-message-id = "{{message.id}}" class="row mb-3  
            {% if user.username == message.to_user.username %} 
            bg-primary rounded-3 
            {% endif %}" >


              <div class="col-auto" >
                  
                  <img 
                    {% if message.is_anonim %}
                      src="{% static 'img/avatar/anonim.png' %}"
                      onclick= "message_to_user_set('–ò–Ω–∫–æ–≥–Ω–∏—Ç–æ'); return false;" 
                    {% else %}
                      src="{{message.from_user.avatar_pic.url}}"
                      name= "{{message.from_user.username}}"
                      onclick= "message_to_user_set(this.getAttribute('name')); return false;"

                    {% endif %}
                      class="image-from"  alt="From">

              </div>
              
                <div class="col">
        
                
                    <div
                    
                    {% if user.username == message.from_user.username %}
                      class="p-3 shadow-sm rounded-3  message-wrapper bg-primary"                      
                    {% else %} 
                      class="p-3 shadow-sm rounded-3  message-wrapper"                       
                    {% endif %}
                      onclick="showContextMenu(event, 'menu-{{ message.id }}')"> <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –º–µ–Ω—é –£–î–ê–õ–ò–¢–¨ –û–¢–í–ï–¢–ò–¢–¨-->
                   
                    

<!--  –ö—Ä–∞—Å–∏–≤—ã–π –∑–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç #75b798 !important -->
                      {% if message.is_anonim %}
                      <div class="text-muted small user-name-in-chat" >–ò–Ω–∫–æ–≥–Ω–∏—Ç–æ
                      {% else %}
                      <div class="text-muted small user-name-in-chat">{{message.from_user.username}}
                      {% endif %}

                      {% if message.to_user != NULL%}
                      –¥–ª—è {{message.to_user.username}} 
                      {% endif %}
                      </div>

                      {% if message.picture != "" %}
                      <div class="picture-in-message">
                         <img  src = "{{ message.picture.url }}"  alt="picture">
                      </div>
                      {% endif %}

                      <div>{{message}}</div>
                      <div class="text-end text-muted small mt-2">{{message.time_send}}</div>

                      <div class="message-context-menu" id="menu-{{ message.id }}">
                        {% if user.username == message.from_user.username %}
                        <button onclick="deleteMessage('{{ message.id }}' )">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                        {% endif %}
                        <button onclick="replyToMessage('{{ message.from_user.username }}')">‚Ü©Ô∏è –û—Ç–≤–µ—Ç–∏—Ç—å</button>
                      </div>



                  </div>
              </div>
          </div>

          {% endfor %}

        
          
      </div>
  </div>




  <!-- –í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ -->



  <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
   <!-- action="{% url 'send_message' %}"  -->
  <form class="input-group mt-3" method="post" id="chatForm" enctype="multipart/form-data">
    {% csrf_token %}
      <div class="row bg-black border-top py-3 " style="padding-right: 0;">

        <div class ="row">
          <div class = "col">

            <!-- –ü—Ä–µ–≤—å—é –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
       
            <img src="" id="preview" style="display: none;" alt="Preview" class = "preview-img">

          </div>

        </div>


        <div class="row">
          <div class="col">
            <input hidden="true" type="text"  id="input-message-to-username" name="message_to">
            <span id="message-to-username" >  </span> <span id="unset-message-to-username" style="cursor: pointer;" onclick="message_to_user_unset(); return false;"></span>
          </div>
        </div>

        <div class="row row-like-input">
          <div class="col">
          
            <div class="input-group  div-like-input" >
              <img src="{% static 'img/system/upload_image.png' %}"  alt="upimg"  onclick ="upload_image()" class="upload-image-icon" >
              <input type="file" id="fileInput"   name="image"   accept="image/*"   hidden  onchange="previewImage(this); ">
                
              <!-- <label for="input_message">–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</label> -->
              <input type="text" name ="message" class="form-control " placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." aria-label="message">
              <button class="btn btn-primary" type="submit">     
                <img src="{% static 'img/system/send_mail.png' %}"  width="30" height="30" alt="send">
              </button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class ="col">
            
            <input type="checkbox" name="is_anonim"  value="true" aria-label="message"><i> –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ</i>
          
          </div>
        </div>
            
      </div>
    </form>
  
  </div>
</div>
                   
                    <!-- {% for i in "x"|ljust:"20" %}
                        <div class="message">–ò–≥—Ä–æ–∫{{ forloop.counter }}: –°–æ–æ–±—â–µ–Ω–∏–µ {{ forloop.counter }}</div>
                    {% endfor %} -->


                </div>
                
            </div>
        </div>
    </div>
</div>



<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
<div class="modal fade" id="numberModal" tabindex="-1" aria-labelledby="numberModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="numberModalLabel">–í—ã–±–µ—Ä–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 3 –¥–æ 6</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
      </div>
      <div class="modal-body">
        <div class="number-selector">
            <div class="arrow-button" id="increaseButton">‚ñ≤</div>
            <div class="number-display" id="numberDisplay">3</div>
            <div class="arrow-button" id="decreaseButton">‚ñº</div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
        <button type="button" class="btn btn-primary" id="confirmButton">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
      </div>
    </div>
  </div>
</div>


</body>


<script src="{% static 'js/display.js' %}"></script>
<script src="{% static 'js/function.js' %}"></script>
<script src="{% static 'js/script.js' %}"></script>
<script src="{% static 'js/events.js' %}"></script>


{% endblock %}